<Page x:Class="QuanLyCaPhe.Views.SharedPage.SchedulePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:QuanLyCaPhe.Views.SharedPage"
      mc:Ignorable="d" 
      Width="auto" Height="auto"
      Title="SchedulePage">

    <Grid Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Padding="20,15" Background="White"
                BorderBrush="#E5E7EB" BorderThickness="0,0,0,1">
            <StackPanel Orientation="Horizontal">
                <Button Content="◀" Click="PrevMonth_Click" Width="30" Height="30" Background="Transparent" BorderThickness="1" BorderBrush="#E5E7EB"/>

                <TextBlock x:Name="txtCurrentMonth" Text="Tháng 12, 2025" 
                           FontSize="18" FontWeight="Bold" Foreground="#1E1B4B" 
                           VerticalAlignment="Center" Margin="15,0" Width="140" TextAlignment="Center"/>

                <Button Content="▶" Click="NextMonth_Click" Width="30" Height="30" Background="Transparent" BorderThickness="1" BorderBrush="#E5E7EB"/>
            </StackPanel>
        </Border>

        <!-- New layout: top-left corner, top header (horizontal), left column (vertical), and main content (both) -->
        <Border Style="{StaticResource LiquidGlassStyle}" Margin="5" Grid.Row="1" UseLayoutRounding="True" SnapsToDevicePixels="True">
            <Grid SnapsToDevicePixels="True" UseLayoutRounding="True">
                <Grid.RowDefinitions>
                    <RowDefinition Height="50"/> <!-- header height -->
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="80"/> <!-- left date column width -->
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Top-left corner (label) -->
                <Border Grid.Row="0" Grid.Column="0" Style="{StaticResource HeaderBorderStyle}" Padding="10,0,0,0">
                    <TextBlock Text="Ngày" VerticalAlignment="Center" Foreground="#6B7280" FontWeight="Bold" />
                </Border>

                <!-- Time headers (horizontal scroll synced with content) -->
                <ScrollViewer x:Name="HeaderScrollViewer" Grid.Row="0" Grid.Column="1" HorizontalScrollBarVisibility="Hidden" VerticalScrollBarVisibility="Disabled" Focusable="False" CanContentScroll="False" Background="Transparent" Padding="0">
                    <Grid x:Name="TimeHeaderGrid" Margin="0" HorizontalAlignment="Left" Height="50" SnapsToDevicePixels="True" UseLayoutRounding="True"/>
                </ScrollViewer>

                <!-- overlapping bar placed at TOP of row1 to cover the gap between header and content -->
                <Border Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Height="6" VerticalAlignment="Top" Background="{StaticResource PrimaryColor}" SnapsToDevicePixels="True" UseLayoutRounding="True" Panel.ZIndex="20"/>

                <!-- Left date column (vertical scroll synced with content) -->
                <ScrollViewer x:Name="LeftScrollViewer" Grid.Row="1" Grid.Column="0" VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Disabled" Focusable="False" CanContentScroll="False" Background="Transparent" Padding="0">
                    <Grid x:Name="DateColumnGrid" Margin="0" SnapsToDevicePixels="True" UseLayoutRounding="True"/>
                </ScrollViewer>

                <!-- Main scrollable content -->
                <ScrollViewer x:Name="ContentScrollViewer" Grid.Row="1" Grid.Column="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" ScrollChanged="ContentScrollViewer_ScrollChanged" CanContentScroll="False" Background="Transparent" Padding="0">
                    <Grid x:Name="ScheduleGrid" Margin="0" SnapsToDevicePixels="True" UseLayoutRounding="True"/>
                </ScrollViewer>
            </Grid>
        </Border>

        <Grid x:Name="PopupOverlay" Grid.RowSpan="2" Visibility="Collapsed" Background="#40000000">
            <Border Width="320" Height="Auto" VerticalAlignment="Center" HorizontalAlignment="Center"
                    Style="{StaticResource GlassPopupStyle}" Padding="20">
                <StackPanel>
                    <TextBlock Text="📅 Đăng Ký Ca Làm" FontSize="18" FontWeight="Bold" Margin="0,0,0,15" Foreground="#1E1B4B"/>

                    <TextBlock Text="Họ và tên" Foreground="#6B7280" Margin="0,0,0,5"/>
                    <ComboBox x:Name="cbName" Height="35" Padding="5" FontSize="14" Margin="0,0,0,15" IsEditable="False"/>

                    <TextBlock Text="Ngày làm việc" Foreground="#6B7280" Margin="0,0,0,5"/>
                    <TextBox x:Name="txtDate" IsReadOnly="True" Background="#F3F4F6" Height="35" Padding="5" FontSize="14" Margin="0,0,0,15"/>

                    <TextBlock Text="Bắt đầu" Foreground="#6B7280" Margin="0,0,0,5"/>
                    <TextBox x:Name="txtStartTime" IsReadOnly="True" Background="#F3F4F6" Height="35" Padding="5" FontSize="14" Margin="0,0,0,15"/>

                    <TextBlock Text="Kết thúc (HH:mm)" Foreground="#6B7280" Margin="0,0,0,5"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <ComboBox x:Name="cbEndHour" Grid.Column="0" Height="35" FontSize="14"/>
                        <TextBlock Text=":" Grid.Column="1" VerticalAlignment="Center" Margin="5"/>
                        <ComboBox x:Name="cbEndMinute" Grid.Column="2" Height="35" FontSize="14"/>
                    </Grid>
                    <TextBlock x:Name="txtError" Text="" Foreground="Red" FontSize="12" Margin="0,5,0,0"/>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
                        <Button Content="Hủy" Click="Cancel_Click" Width="80" Height="30" Background="Transparent" BorderThickness="0" Foreground="#6B7280"/>
                        <Button Content="Xác nhận" Click="Confirm_Click" Width="90" Height="30" Background="#4F46E5" Foreground="White" BorderThickness="0" Margin="10,0,0,0">
                            <Button.Resources>
                                <Style TargetType="Border">
                                    <Setter Property="CornerRadius" Value="6"/>
                                </Style>
                            </Button.Resources>
                        </Button>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Page>
